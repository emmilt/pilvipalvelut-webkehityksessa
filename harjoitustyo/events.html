<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tapahtumat</title>
    <link rel="stylesheet" href="styles.css">
    <script type="module" src="app.js"></script>
</head>
<body>
    <nav>
        <ul>
            <li><a href="index.html">Etusivu</a></li>
            <li><a href="events.html">Tapahtumat</a></li>
            <li><a href="add-event.html">Lisää Tapahtuma</a></li>
            <li><a href="login.html">Kirjaudu sisään</a></li>
        </ul>
    </nav>

    <header>
        <h1>Tapahtumat</h1>
        <label for="search">Etsi Tapahtuma:</label>
        <input type="text" id="search" placeholder="Hae tapahtumaa...">
        <button id="searchBtn">Hae</button>
    </header>

    <section id="events">
    </section>

    <footer>
        <p>&copy; 2024 Paikalliset Tapahtumat</p>
    </footer>

    <script>
      // Haku-toiminto tapahtumien etsimiseksi
      document.getElementById("searchBtn").addEventListener("click", function() {
        const searchQuery = document.getElementById("search").value.toLowerCase(); // Hae hakukysely
        fetch('https://www.eventbriteapi.com/v3/events/search/?location.address=Helsinki&token=JKWYMCEBH44ICM6IN5U7')
          .then(response => response.json())
          .then(data => {
            const filteredEvents = data.filter(event => 
              event.name.toLowerCase().includes(searchQuery)
            );
            displayEvents(filteredEvents);
          })
          .catch(error => console.error('Virhe hakutapahtumassa', error));
      });

      // Funktio, joka renderöi tapahtumat HTML:ssä
      function displayEvents(events) {
        const eventsSection = document.getElementById('events');
        eventsSection.innerHTML = "";

        if (events.length > 0) {
          events.forEach(event => {
            const eventDiv = document.createElement('div');
            eventDiv.innerHTML = `
              <h3>${event.name}</h3>
              <p>${event.date}</p>
              <p>${event.location}</p>
            `;
            eventsSection.appendChild(eventDiv);
          });
        } else {
          eventsSection.innerHTML = "<p>Ei löytynyt tapahtumia hakusanaasi vastaavasti.</p>";
        }
      }
    </script>

</body>
</html>
